%% Filename      : java.sty 
%% Author(s)     : Michael Whittaker (mjw297@cornell.edu)
%% Last Modified : 2014-2-16
\ProvidesPackage{java}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Imports
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Colors
\RequirePackage[usenames,dvipsnames,svgnames,table]{xcolor}

% Typesetting code
\RequirePackage{listings}

% Relative font sizes
\RequirePackage{relsize}

% Listing Captions
\RequirePackage{caption}

% DVSM font
\RequirePackage{DejaVuSansMono}

% Calculator (widthof)
\RequirePackage{calc}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Colors
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{BackgroundGreen}{HTML}{E6F0F0}
\definecolor{NoteBackground}{HTML}{FFFCE3}
\definecolor{BackgroundBeige}{HTML}{FDF6E3}
\definecolor{BackgroundYellow}{HTML}{FEFBDF}
\definecolor{SolarizedGrey}{HTML}{657B83}
\definecolor{CornellRed}{HTML}{B31B1B}
\definecolor{OracleRed}{HTML}{FF0000} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Captions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{%
  \colorbox[HTML]{3675a9}{%
    \parbox{\dimexpr\textwidth-2\fboxsep\relax}{#1#2#3}
  }
}
\captionsetup[Java]{%
  format=listing,
  labelfont=white,
  textfont=white,
  singlelinecheck=false,
  margin=0pt,
  font={bf,small}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lengths
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newlength{\charwidth}
\setlength{\charwidth}{\widthof{\tt{a}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Python Typesetting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\lstdefinelanguage{Java}{%
  % Basic settings
  basicstyle=\smaller\ttfamily,
  tabsize=4,
  showstringspaces=false,
  mathescape=true,
  breaklines=true,
  numbers=left,
  % Keywords, strings, and comments
  keywords={%
    abstract, continue, for, new, switch, assert, default, goto, package,
    synchronized, boolean, do, if, private, this, break, double, implements,
    protected, throw, byte, else, import, public, throws, case, enum,
    instanceof, return, transient, catch, extends, int, short, try, char,
    final, interface, static, void, class, finally, long, strictfp, volatile,
    const, float, native, super, while
  },
  keywords=[2]{%
  },
  morestring=[b]",
  morestring=[b]',
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  % Colors and style
  keywordstyle=\color{blue},
  keywordstyle=[2]\color{DarkOrchid},
  commentstyle=\color{ForestGreen},
  stringstyle=\color{Red},
  numberstyle=\color{SolarizedGrey}
}

\lstnewenvironment{Java}[1][]{%
  \lstset{%
    language=Java,
    linewidth=80\charwidth,
    #1
  }
  \captionsetup{options=Java}
}{}

\newcommand*{\java}{\lstinline[{language=Java}]}

\newcommand{\inputjava}[2][ ]{{%
  \captionsetup{options=Java}
  \lstset{linewidth=80\charwidth}
  \lstinputlisting[language=Java,#1]{#2} 
}}
